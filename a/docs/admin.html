<!DOCTYPE html>
<html>
<head>
  <title>Admin Wallet Recharge</title>
</head>
<body>

<h2>ðŸ’¼ Admin Wallet Recharge</h2>

<label>Select User:</label><br>
<select id="userSelect"></select>

<br><br>

<label>Amount (â‚¹):</label><br>
<input id="amount" type="number" placeholder="Enter amount">

<br><br>

<button onclick="recharge()">ðŸ’³ Recharge Wallet</button>

<hr>

<p id="result"></p>

<script>
const API = "https://bappa-s-web.onrender.com";

// ðŸ”¹ load all users
async function loadUsers(){
  const res = await fetch(API + "/users");
  const users = await res.json();

  const sel = document.getElementById("userSelect");
  sel.innerHTML = "";

  users.forEach(u=>{
    const opt = document.createElement("option");
    opt.value = u._id;
    opt.textContent = `${u.name} (${u.email})`;
    sel.appendChild(opt);
  });
}

// ðŸ”¹ recharge wallet
async function recharge(){
  const userId = document.getElementById("userSelect").value;
  const amount = Number(document.getElementById("amount").value);

  if(!userId || amount <= 0){
    alert("Invalid input");
    return;
  }

  const res = await fetch(API + "/users/wallet/add",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ userId, amount })
  });

  const data = await res.json();

  if(data.wallet !== undefined){
    document.getElementById("result").innerText =
      `âœ… Recharge success. New Balance: â‚¹${data.wallet}`;
  }else{
    document.getElementById("result").innerText =
      "âŒ Failed: " + (data.error || "Unknown error");
  }
}

loadUsers();
</script>

</body>
</html>
